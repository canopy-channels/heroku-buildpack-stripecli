#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir> <env-dir>

set -e

function indent() {
  c='s/^/       /'
  case $(uname) in
    Darwin) sed -l "$c";;
    *)      sed -u "$c";;
  esac
}

STRIPE_CLI_URL="https://github.com/stripe/stripe-cli/releases/download/v1.4.5/stripe_1.4.5_linux_x86_64.tar.gz"

echo "-----> Installing Stripe CLI"
mkdir -p $BUILD_DIR/.stripe
cd $BUILD_DIR/.stripe
curl -L "$STRIPE_CLI_URL" | tar zx |& indent
export PATH="$BUILD_DIR/.stripe:$PATH"
echo "Created stripe command in $BUILD_DIR/.stripe"
